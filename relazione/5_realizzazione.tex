\documentclass[1_relazione.tex]{subfiles}
\begin{document}

\section{Realizzazione}
Questa sezione illustra i passi per la realizzazione di FRENT.  I criteri che abbiamo utilizzato sono:
\begin{itemize}
\item Separazione fra struttura, presentazione e comportamento;
\item Garantire l'accessibilit\`{a};
\item Scelta della corretta tecnologia da impiegare.
\end{itemize}

\subsection{Base di dati}
La base di dati \`{e} stata la prima parte del progetto codificata. A partire dallo schemi ER abbiamo creato le entit\`{a} e le relazioni in SQL. Abbiamo controllato con attenzione le politiche di reazione in caso di cancellazione e modifiche ai dati, in modo che la base di dati fosse sempre coerente. Inoltre abbiamo deciso di implementare tutte le funzionalit\`{a} di base offerte dal sito come funzioni e procedure SQL.

\subsection{Struttura}
Il punto di partenza per la creazione del sito sono state le pagine statiche. In tutte le pagine abbiamo prestato attenzione ai tag utilizzati e a rispettarne il significato semantico come visto in classe e nei laboratori. Abbiamo deciso di implementare le pagine in xhtml e utilizzare htlm5 solo per quelle pagine in cui era indispensabile.\\ Una componente fondamentale per il funzionamento del sito sono le date il guest deve sempre indicare la data di inizio e di fine di una prenotazione. Per facilitare l'inserimento di questo dato abbiamo scelto di utilizzare il widget-calendario offerto dalla maggior parte dei browser quando è richiesta una data. Abbiamo giudicato improponibile chiedere al guest di inserire 6 numeri (in un formato specifico per giunta) per ogni ricerca. Le pagine di home, elenco risultati e dettagli annunci sono perci\`{o} implementate con html5. \\
Abbiamo inoltre implementato gli schemi esatti che sono stati introdotti nella sezione di progettazione realizzati sotto forma di liste. In questa fase abbiamo realizzato gli header e i footer che poi sarebbero stati scelti dinamicamente in un secondo momento. \\
%Per ragioni di accessibilit\`{a}, tutti i form sono racchiusi nel tag fieldset e utilizzano il tag legend .
%Le pagine cosi composte ci hanno permesso di capire se stavamo andando nella direzione giusta. Una delle decisione che abbiamo preso \`{e} stata rimuovere una delle funzionalit\`{a} che avevamo imposta all'inizio, l'elenco degli annunci preferiti del guest (non riportato nello schema).

\subsection{Presentazione}
Il secondo passaggio \`{e} stata la presentazione. In questo paragrafo riportiamo i punti pi\`{u} rilevanti. Abbiamo creato un file .css separato per la presentazione che poi abbiamo inserito nella pagine .html. Il font utilizzato per le pagine \`{e} quello senza grazie (sans-serif), per migliorarne la leggibilit\`{a}. Il font utilizzato per la stampa delle pagine \`{e} invece con grazie. Questo per garantire migliore leggibilit\`{a} dei contenuti.  \\
 % Grid
Per organizzare gli elementi nella pagina abbiamo utilizzato i grid layout. L'uso di questa tecnologia ha permesso di ottenere ottimi risultati in breve tempo. Abbiamo impostato tre tipi di grid:
\begin{itemize}
\item \textbf{Layout colonna} La pagina è formata da un'unica colonna.
\item \textbf{Layout a tre pannelli} Layout formato da tre pannelli uno superiore e due affiancati.
\item \textbf{Layout centrale} La pagina è formata da un'unica colonna, ma viene data maggiore enfasi alla zona centrale. Tutti i form utilizzano questo layout
\end{itemize}

Lo svantaggio di utilizzare Grid \`{e} che non garantisce retrocompatibilt\`{a} con i browser pi\`{u} vecchi, ad esempio Internet Explorer. Tuttavia come illustrato in precedenza la percentuale attesa di utenti di FRENT che usano Internet Explorer \`{e} talmente bassa da giustificare l'utilizzo di Grid. In un secondo momento abbiamo introdotto alcune impostazioni CSS specifiche per Internet Explorer. \\
% Form
Tutti i form rispettano le stesse convenzioni interne per non creare disorientamento nell'utente. Per modificare e inserire i dati abbiamo utilizzato dei form posizionati al centro della pagina. Nel momento in cui l'utente modifica i dati non ha bisogno di accedere ad altre tipologie di informazioni all'interno della pagina. Fanno eccezione i form orizzontali e verticali di ricerca annunci che per\`{o} devono essere integrati nella pagina come abbiamo spiegato nella sezione sulla progettazione.

% Colore
Per scegliere i colori abbiamo utilizzato un palette messa a disposizione dalla W3C. La scelta del colore \`{e} stata fatta in modo da evitare possibili problemi di contrasto dopo aver provato diverse combinazioni. Non abbiamo l'esperienza necessaria per poter fare una scelta precisa dei colori. Abbiamo quindi cercato di utilizzare i colori nel modo pi\`{u} semplice possibile per non creare disorientamento nell'utente.

\subsection{Comportamento}
Per gestire il comportamento del sito abbiamo usato due tecnologie, PHP (lato server) e JavaScript (lato client).

\subsubsection{PHP}
Per rendere il sito dinamico \`{e} stato utilizzato il linguaggio PHP.
La struttura del sistema \`{e} composta da:
\begin{itemize}
    \item classe \textbf{Database}: permette l'apertura e la chiusura di connessioni con il database MySQL realizzato e illustrato nella sezione Progettazione.
    Avendo realizzato una funzione o una procedura SQL per ogni funzionalit\`{a} offerta dal sito, sono presenti due metodi queryProcedure e queryFunction ottimizzati per l'interrogazione del database rispettivamente con procedure e funzioni.
    \item classe \textbf{Frent}: permette di effettuare le chiamate alle procedure o funzioni presenti nel database. Si interfaccia con la classe Database per le interrogazioni e si occupa di controllare gli input inseriti dall'utente e di segnalare violazioni di precondizioni sui dati;
    \item classi \textbf{Amministratore}, \textbf{Annuncio}, \textbf{Commento}, \textbf{Prenotazione}, \textbf{Utente}: sono delle classi che rappresentano le entit\`{a} del database. Contengono metodi set e get per ogni attributo presente nella rispettiva tabella del database e si occupano anche del controllo di validit\`{a} degli input;
    \item classe \textbf{CredenzialiDB}: viene usata per salvare i dati di accesso al database MySQL;
    \item classe \textbf{DataConstraints}: \`{e} una classe di raccolta che viene usata per salvare i limiti di lunghezza dei dati impostati nel database, permettendo cos\`{i} la gestione centralizzata. In questo modo, le eventuali modifiche alla dimensione di un campo di una determinata tabella pu\`{o} essere propagata facilmente a tutto il sito;
    \item Classe ImageManager: % todo
    \item pagine: le pagine PHP vengono create prendendo in input la pagina html statica corrispondente, e sostituendo i vari FLAG di posizione con le informazioni reperite dal database. Queste pagine non interagiscono direttamente con il database, ma lo fanno chiamando i metodi della classe Frent. Anche questa scelta \`{e} dettata di tenere in modo centralizzato le parti che nei futuri sviluppi potrebbero subire modifiche.
    \item  Script: sono dei script php che servono per effettuare delle operazioni, una queste operazioni \`{e} il logout.
    \item classi loader: sono due load\_frent.php e load\_header sono delle classi contengono dei codici php ripetute in quasi tutte le pagine o script, per cui si \`{e} deciso di raccoglierli e di inserirlo in queste classi.
\end{itemize}

Le pagine PHP sono state create utilizzando meno possibile il codice HTML nei file PHP, per esempio, nella pagina miei\_annunci.php la definizione dei singoli annunci \`{e} stata fatta nel file \textit{components/item\_mio\_annuncio.html}, in questo modo \`{e} stata garantita la pulizia del codice PHP senza inquinarla con codice HTML ad eccezione della \textit{classe load\_header.php}. Nei casi in cui il codice HTML richiesto \`{e} di una sola riga, si \`{e} deciso di inserirlo direttamente.

Quando vengono lanciati degli errori dalle chiamate alle funzioni dela classe Frent.php, se l'errore \`{e} stato causato dall'inserimento errato di un valore, viene mostrato il messaggio di errore, mentre se non \`{e} stato causato dall'utente, la pagina reagisce in uno dei seguenti modi:
\begin{enumerate}
    \item l'utente viene re-indirizzato alla pagina error\_page.php con eventuale messaggio di errore;
    \item l'utente viene re-indirizzato alla pagina 404.php;
    \item interviene il server e mostra l'eventuale errore. 
\end{enumerate}

\subsubsection{Javascript}
Il linguaggio JavaScript \`{e} stato impiegato per effettuare i controlli lato client (direttamente dal browser) sull'input inserito dall'utente nei diversi form.
Il file \textit{form\_validator.js} contiene i metodi che vengono richiamati dai form nell'attributo \textit{onsubmit}.\\
I metodi direttamente chiamati sono i metodi che cominciano con \textit{validazione\_nome\_form}, ed sar\`{a} quest'ultimo che richiama i singoli metodi per controllare la validit\`{a} dei valori inseriti dall'utente.
Se il valore inserito non \`{e} valido viene inserito un elemento d \textit{strong} che contiene il messaggio di errore.


\end{document}